---
  apiVersion: koreo.dev/v1beta1
  kind: ResourceFunction
  metadata:
    name: gcp-environment-k8s-service-account
  spec:
    locals:
      name: =inputs.metadata.name + "-workload-ksa"
    apiConfig:
      apiVersion: v1
      kind: ServiceAccount
      name: =locals.name
      namespace: =inputs.metadata.namespace
  
    resource:
      metadata:
        annotations:
          iam.gke.io/gcp-service-account: =inputs.saName + "@" + inputs.projectId + ".iam.gserviceaccount.com"
    return:
      name: =locals.name
  